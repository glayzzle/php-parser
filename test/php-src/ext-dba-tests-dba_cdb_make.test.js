// eslint-disable prettier/prettier
const parser = require("../main");

describe("php-src tests", function () {
  // ext/dba/tests/dba_cdb_make.phpt
  it("DBA CDB_MAKE handler test", function () {
    expect(parser.parseCode("<?php\n    $handler = 'cdb_make';\n    require_once(__DIR__ .'/test.inc');\n    echo \"database handler: $handler\\n\";\n    // print md5 checksum of test.cdb which is generated by cdb_make program\n    var_dump(md5_file(__DIR__.'/test.cdb'));\n    if (($db_make=dba_open($db_file, \"n\", $handler))!==FALSE) {\n        dba_insert(\"1\", \"1\", $db_make);\n        dba_insert(\"2\", \"2\", $db_make);\n        dba_insert(\"1\", \"3\", $db_make);\n        dba_insert(\"2\", \"1\", $db_make);\n        dba_insert(\"3\", \"3\", $db_make);\n        dba_insert(\"1\", \"2\", $db_make);\n        dba_insert(\"4\", \"4\", $db_make);\n//\t\tdba_replace cdb_make doesn't know replace\n        dba_close($db_make);\n        // write md5 checksum of generated database file\n        var_dump(md5_file($db_file));\n        // no need to test created database: this is done by dba_cdb_read.phpt\n    } else {\n        echo \"Error creating database\\n\";\n    }\n?>")).toMatchSnapshot();
  });
});
