// eslint-disable prettier/prettier
const parser = require("../main");

describe("php-src tests", function () {
  // ext/oci8/tests/bind_sqltchr_1.phpt
  it("Bind with SQLT_CHR", function () {
    expect(parser.parseCode("<?php\nrequire(__DIR__.'/connect.inc');\n// Initialization\n$stmtarray = array(\n    \"drop table bind_sqltchr_tab\",\n    \"create table bind_sqltchr_tab (\n        id                number,\n        varchar2_t10      varchar2(10),\n        number_t          number,\n        number_t92        number(9,2))\"\n);\noci8_test_sql_execute($c, $stmtarray);\nfunction check_col($c, $colname, $id)\n{\n    $s = oci_parse($c, \"select $colname from bind_sqltchr_tab where id = :id\");\n    oci_bind_by_name($s, \":id\", $id);\n    oci_execute($s);\n    oci_fetch_all($s, $r);\n    var_dump($r);\n}\n// Run Test\necho \"\\nTEST241 bind SQLT_CHR\\n\";\n$c2 = \"Hood241\";\n$s = oci_parse($c, \"INSERT INTO bind_sqltchr_tab (id, varchar2_t10) VALUES (241, :c2)\");\noci_bind_by_name($s, \":c2\", $c2, -1, SQLT_CHR);\noci_execute($s);\ncheck_col($c, 'varchar2_t10', 241);\necho \"\\nTEST242 insert numbers SQLT_CHR\\n\";\n$s = oci_parse($c, \"INSERT INTO bind_sqltchr_tab (id, number_t) VALUES (242, :n1)\");\n$n1 = 42;\noci_bind_by_name($s, \":n1\", $n1, -1, SQLT_CHR);\noci_execute($s);\ncheck_col($c, 'number_t', 242);\necho \"\\nTEST243 insert numbers, SQLT_CHR\\n\";\n$s = oci_parse($c, \"INSERT INTO bind_sqltchr_tab (id, number_t) VALUES (243, :n1)\");\n$n1 = 42.69;\noci_bind_by_name($s, \":n1\", $n1, -1, SQLT_CHR);\noci_execute($s);\ncheck_col($c, 'number_t', 243);\necho \"\\nTEST244 insert numbers with SQLT_CHR\\n\";\n$s = oci_parse($c, \"INSERT INTO bind_sqltchr_tab (id, number_t) VALUES (244, :n1)\");\n$n1 = 0;\noci_bind_by_name($s, \":n1\", $n1, -1, SQLT_CHR);\noci_execute($s);\ncheck_col($c, 'number_t', 244);\necho \"\\nTEST245 insert numbers with SQLT_CHR\\n\";\n$s = oci_parse($c, \"INSERT INTO bind_sqltchr_tab (id, number_t) VALUES (245, :n1)\");\n$n1 = -23;\noci_bind_by_name($s, \":n1\", $n1, -1, SQLT_CHR);\noci_execute($s);\ncheck_col($c, 'number_t', 245);\necho \"\\nTEST246 insert numbers\\n\";\n$s = oci_parse($c, \"INSERT INTO bind_sqltchr_tab (id, number_t) VALUES (246, :n1)\");\n$n1 = \"-23\";\noci_bind_by_name($s, \":n1\", $n1, -1, SQLT_CHR);\noci_execute($s);\ncheck_col($c, 'number_t', 246);\necho \"\\nTEST247 insert numbers with SQLT_CHR\\n\";\n$s = oci_parse($c, \"INSERT INTO bind_sqltchr_tab (id, number_t) VALUES (247, :n1)\");\n$n1 = \"23\";\noci_bind_by_name($s, \":n1\", $n1, -1, SQLT_CHR);\noci_execute($s);\ncheck_col($c, 'number_t', 247);\necho \"\\nTEST248 insert numbers with SQLT_CHR\\n\";\n$s = oci_parse($c, \"INSERT INTO bind_sqltchr_tab (id, number_t92) VALUES (248, :n1)\");\n$n1 = 123.56;\noci_bind_by_name($s, \":n1\", $n1, -1, SQLT_CHR);\noci_execute($s);\ncheck_col($c, 'number_t92', 248);\necho \"\\nTEST249 insert numbers with SQLT_CHR\\n\";\n$s = oci_parse($c, \"INSERT INTO bind_sqltchr_tab (id, number_t92) VALUES (249, :n1)\");\n$n1 = \"123.56\";\noci_bind_by_name($s, \":n1\", $n1, -1, SQLT_CHR);\noci_execute($s);\ncheck_col($c, 'number_t92', 249);\necho \"\\nTEST250 insert numbers with SQLT_CHR\\n\";\n$s = oci_parse($c, \"INSERT INTO bind_sqltchr_tab (id, number_t92) VALUES (250, :n1)\");\n$n1 = \"\";\noci_bind_by_name($s, \":n1\", $n1, -1, SQLT_CHR);\noci_execute($s);\ncheck_col($c, 'number_t92', 250);\n// Clean up\n$stmtarray = array(\n    \"drop table bind_sqltchr_tab\"\n);\noci8_test_sql_execute($c, $stmtarray);\n?>")).toMatchSnapshot();
  });
});
