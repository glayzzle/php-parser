// eslint-disable prettier/prettier
const parser = require("../main");

describe("php-src tests", function () {
  // ext/session/tests/session_basic3.phpt
  it("Test basic function : variation3 use_trans_sid", function () {
    expect(parser.parseCode("<?php\nob_start();\necho \"*** Testing basic session functionality : variation3 use_trans_sid ***\\n\";\n/*\necho \"*** test output_add_rewrite_var() ***\\n\";\noutput_add_rewrite_var('var', 'value');\necho '\n<a href=\"/\">test</a>\n<a href=\"/#bar\">test</a>\n<a href=\"/?foo\">test</a>\n<a href=\"/?foo#bar\">test</a>\n<a href=\"/?foo=var\">test</a>\n<a href=\"/?foo=var#bar\">test</a>\n<a href=\"file.php\">test</a>\n<a href=\"file.php?foo\">test</a>\n<a href=\"file.php?foo=var\">test</a>\n<a href=\"http://php.net\">test</a>\n<a href=\"http://php.net/\">test</a>\n<a href=\"http://php.net/#bar\">test</a>\n<a href=\"http://php.net/?foo\">test</a>\n<a href=\"http://php.net/?foo#bar\">test</a>\n<a href=\"http://php.net/?foo=var\">test</a>\n<a href=\"http://php.net/?foo=var#bar\">test</a>\n<a href=\"http://php.net/file.php\">test</a>\n<a href=\"http://php.net/file.php#bar\">test</a>\n<a href=\"http://php.net/file.php?foo\">test</a>\n<a href=\"http://php.net/file.php?foo#bar\">test</a>\n<a href=\"http://php.net/file.php?foo=var\">test</a>\n<a href=\"http://php.net/file.php?foo=var#bar\">test</a>\n<a href=\"http://php.net/some/path/file.php\">test</a>\n<a href=\"http://php.net/some/path/file.php?foo\">test</a>\n<a href=\"http://php.net/some/path/file.php?foo=var\">test</a>\n<a href=\"http://php.net/some/path/file.php?foo=var#bar\">test</a>\n<a href=\"https://php.net\">test</a>\n<a href=\"https://php.net/\">test</a>\n<a href=\"https://php.net/?foo=var#bar\">test</a>\n<a href=\"https://php.net/file.php\">test</a>\n<a href=\"https://php.net/file.php?foo=var#bar\">test</a>\n<a href=\"https://php.net/some/path/file.php\">test</a>\n<a href=\"https://php.net/some/path/file.php?foo=var#bar\">test</a>\n<a href=\"https://php.net:8443\">test</a>\n<a href=\"https://php.net:8443/\">test</a>\n<a href=\"https://php.net:8443/?foo=var#bar\">test</a>\n<a href=\"https://php.net:8443/file.php\">test</a>\n<a href=\"https://php.net:8443/file.php?foo=var#bar\">test</a>\n<a href=\"https://php.net:8443/some/path/file.php\">test</a>\n<a href=\"https://php.net:8443/some/path/file.php?foo=var#bar\">test</a>\n<a href=\"//php.net\">test</a>\n<a href=\"//php.net/\">test</a>\n<a href=\"//php.net/#bar\">test</a>\n<a href=\"//php.net/?foo\">test</a>\n<a href=\"//php.net/?foo#bar\">test</a>\n<a href=\"//php.net/?foo=var\">test</a>\n<a href=\"//php.net/?foo=var#bar\">test</a>\n<a href=\"//php.net/file.php\">test</a>\n<a href=\"//php.net/file.php#bar\">test</a>\n<a href=\"//php.net/file.php?foo\">test</a>\n<a href=\"//php.net/file.php?foo#bar\">test</a>\n<a href=\"//php.net/file.php?foo=var\">test</a>\n<a href=\"//php.net/file.php?foo=var#bar\">test</a>\n<a href=\"//php.net/some/path/file.php\">test</a>\n<a href=\"//php.net/some/path/file.php?foo\">test</a>\n<a href=\"//php.net/some/path/file.php?foo=var\">test</a>\n<a href=\"//php.net/some/path/file.php?foo=var#bar\">test</a>\n<form action=\"script.php\" method=\"post\">\n  <input type=\"text\" name=\"test1\"></input>\n  <input type=\"text\" name=\"test2\" />\n</form>\n';\noutput_reset_rewrite_vars();\n*/\necho \"*** Test trans sid ***\\n\";\nob_start();\n$session_id = 'session-basic3';\nsession_id($session_id);\nsession_start();\n// Should add session ID to relative URL only for SECURITY\necho '\n<a href=\"/\">test</a>\n<a href=\"/path\">test</a>\n<a href=\"/path/\">test</a>\n<a href=\"/path/?foo=var\">test</a>\n<a href=\"../\">test</a>\n<a href=\"../path\">test</a>\n<a href=\"../path/\">test</a>\n<a href=\"../path/?foo=var\">test</a>\n<a href=\"/#bar\">test</a>\n<a href=\"/path/#bar\">test</a>\n<a href=\"/path/?foo=var#bar\">test</a>\n<a href=\"../#bar\">test</a>\n<a href=\"../path/#bar\">test</a>\n<a href=\"../path/?foo=var#bar\">test</a>\n<a href=\"/?foo\">test</a>\n<a href=\"/?foo#bar\">test</a>\n<a href=\"/?foo=var\">test</a>\n<a href=\"/?foo=var#bar\">test</a>\n<a href=\"../?foo\">test</a>\n<a href=\"../?foo#bar\">test</a>\n<a href=\"../?foo=var\">test</a>\n<a href=\"../?foo=var#bar\">test</a>\n<a href=\"file.php\">test</a>\n<a href=\"file.php?foo\">test</a>\n<a href=\"file.php?foo=var\">test</a>\n<a href=\"file.php?foo=var#bar\">test</a>\n<a href=\"../file.php\">test</a>\n<a href=\"../file.php?foo\">test</a>\n<a href=\"../file.php?foo=var\">test</a>\n<a href=\"../file.php?foo=var#bar\">test</a>\n<a href=\"http://php.net\">test</a>\n<a href=\"http://php.net/\">test</a>\n<a href=\"http://php.net/#bar\">test</a>\n<a href=\"http://php.net/?foo\">test</a>\n<a href=\"http://php.net/?foo#bar\">test</a>\n<a href=\"http://php.net/?foo=var\">test</a>\n<a href=\"http://php.net/?foo=var#bar\">test</a>\n<a href=\"http://php.net/file.php\">test</a>\n<a href=\"http://php.net/file.php#bar\">test</a>\n<a href=\"http://php.net/file.php?foo\">test</a>\n<a href=\"http://php.net/file.php?foo#bar\">test</a>\n<a href=\"http://php.net/file.php?foo=var\">test</a>\n<a href=\"http://php.net/file.php?foo=var#bar\">test</a>\n<a href=\"http://php.net/some/path/file.php\">test</a>\n<a href=\"http://php.net/some/path/file.php?foo\">test</a>\n<a href=\"http://php.net/some/path/file.php?foo=var\">test</a>\n<a href=\"http://php.net/some/path/file.php?foo=var#bar\">test</a>\n<a href=\"https://php.net\">test</a>\n<a href=\"https://php.net/\">test</a>\n<a href=\"https://php.net/?foo=var#bar\">test</a>\n<a href=\"https://php.net/file.php\">test</a>\n<a href=\"https://php.net/file.php?foo=var#bar\">test</a>\n<a href=\"https://php.net/some/path/file.php\">test</a>\n<a href=\"https://php.net/some/path/file.php?foo=var#bar\">test</a>\n<a href=\"https://php.net:8443\">test</a>\n<a href=\"https://php.net:8443/\">test</a>\n<a href=\"https://php.net:8443/?foo=var#bar\">test</a>\n<a href=\"https://php.net:8443/file.php\">test</a>\n<a href=\"https://php.net:8443/file.php?foo=var#bar\">test</a>\n<a href=\"https://php.net:8443/some/path/file.php\">test</a>\n<a href=\"https://php.net:8443/some/path/file.php?foo=var#bar\">test</a>\n<a href=\"//php.net\">test</a>\n<a href=\"//php.net/\">test</a>\n<a href=\"//php.net/#bar\">test</a>\n<a href=\"//php.net/?foo\">test</a>\n<a href=\"//php.net/?foo#bar\">test</a>\n<a href=\"//php.net/?foo=var\">test</a>\n<a href=\"//php.net/?foo=var#bar\">test</a>\n<a href=\"//php.net/file.php\">test</a>\n<a href=\"//php.net/file.php#bar\">test</a>\n<a href=\"//php.net/file.php?foo\">test</a>\n<a href=\"//php.net/file.php?foo#bar\">test</a>\n<a href=\"//php.net/file.php?foo=var\">test</a>\n<a href=\"//php.net/file.php?foo=var#bar\">test</a>\n<a href=\"//php.net/some/path/file.php\">test</a>\n<a href=\"//php.net/some/path/file.php?foo\">test</a>\n<a href=\"//php.net/some/path/file.php?foo=var\">test</a>\n<a href=\"//php.net/some/path/file.php?foo=var#bar\">test</a>\n<form action=\"script.php\" method=\"post\">\n  <input type=\"text\" name=\"test1\"></input>\n  <input type=\"text\" name=\"test2\" />\n</form>\n<form action=\"../script.php\" method=\"post\">\n  <input type=\"text\" name=\"test1\"></input>\n  <input type=\"text\" name=\"test2\" />\n</form>\n<form action=\"/path/script.php\" method=\"post\">\n  <input type=\"text\" name=\"test1\"></input>\n  <input type=\"text\" name=\"test2\" />\n</form>\n<form action=\"../path/script.php\" method=\"post\">\n  <input type=\"text\" name=\"test1\"></input>\n  <input type=\"text\" name=\"test2\" />\n</form>\n<form method=\"post\" action=\"http://php.net/script.php\">\n  <input type=\"text\" name=\"test1\"></input>\n  <input type=\"text\" name=\"test2\" />\n</form>\n<form method=\"post\" action=\"https://php.net/script.php\">\n  <input type=\"text\" name=\"test1\"></input>\n  <input type=\"text\" name=\"test2\" />\n</form>\n<form method=\"post\" action=\"//php.net/script.php\">\n  <input type=\"text\" name=\"test1\"></input>\n  <input type=\"text\" name=\"test2\" />\n</form>\n';\nvar_dump(session_commit());\necho \"*** Cleanup ***\\n\";\nvar_dump(session_start());\nvar_dump(session_id());\nvar_dump(session_destroy());\nob_end_flush();\n?>")).toMatchSnapshot();
  });
});
