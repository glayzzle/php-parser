// eslint-disable prettier/prettier
const parser = require("../main");

describe("php-src tests", function () {
  // ext/filter/tests/030.phpt
  it("filter_var() and IPv6", function () {
    expect(parser.parseCode("<?php\n$ipv6_test = array(\n    \"::127.0.0.1\"\t\t\t\t\t=> true,\n    \"FF01::101:127.0.1\" \t\t\t=> false,\n    \"FF01:0:0:0:101:127.0.1.1\"\t\t=> false,\n    \"FF01:0:0:0:237:101:127.0.1.1\"\t=> true,\n    \"FF01::101\"\t\t\t\t\t\t=> true,\n    \"A1080::8:800:200C:417A\"\t\t=> false,\n    \"1080::8:Z00:200C:417A\"\t\t\t=> false,\n    \"FF01::101::1\"\t\t\t\t\t=> false,\n    \"1080::8:800:200C:417A\"\t\t\t=> true,\n    \"1080:0:0:0:8:800:200C:417A\"\t=> true,\n    \"2001:ec8:1:1:1:1:1:1\"\t\t\t=> true,\n    \"ffff::FFFF:129.144.52.38\"\t\t=> true,\n    \"::ffff:1.2.3.4\"\t\t\t\t=> true,\n    \"0:0:0:0:0:FFFF:129.144.52.38\"\t=> true,\n    \"0:0:0:0:0:0:13.1.68.3\"\t\t\t=> true,\n    \"0:0:0:0:0:0:0:13.1.68.3\"\t\t=> false,\n    \"::13.1.68.3\"\t\t\t\t\t=> true,\n    \"::FFFF:129.144.52.38\"\t\t\t=> true,\n    \"1:2:3:4:5:6::129.144.52.38\"\t=> false,\n    \"::1:2:3:4:5:6:129.144.52.38\"\t=> false,\n    \"1:2:3::4:5:6:129.144.52.38\"\t=> false,\n    \"1:2:3:4::5:6:7:8\"\t\t\t\t=> false,\n    \"::1:2:3:4:5:6:7\"\t\t\t\t=> true,\n    \"::1:2:3:4:5:6:7:8\"\t\t\t\t=> false,\n    \"1:2:3:4:5:6:7::\"\t\t\t\t=> true,\n    \"1:2:3:4:5:6:7:8::\"\t\t\t\t=> false,\n    \"1:2:3:4:5:6:7::8\"\t\t\t\t=> false,\n    \"1:2:3:4:5:6:7:8g\"\t\t\t\t=> false,\n    \"1:2:3:4:5:6:7:g\"\t\t\t\t=> false,\n    \"1:2:3:4:5g:6:7:8\"\t\t\t\t=> false,\n    'a:b:c:d:e::1.2.3.4'\t\t\t=> true,\n    '::0:a:b:c:d:e:f'\t\t\t\t=> true,\n    '0:a:b:c:d:e:f::'\t\t\t\t=> true,\n    ':::1.2.3.4'\t\t\t\t\t=> false,\n    '8:::1.2.3.4'\t\t\t\t\t=> false,\n    '::01.02.03.04'\t\t\t\t\t=> false,\n    '::1.00.3.4'\t\t\t\t\t=> false,\n    '0:0:0:255.255.255.255'\t\t\t=> false,\n    '0:0:0::255.255.255.255'\t\t=> true,\n);\nforeach ($ipv6_test as $ip => $exp) {\n    $out = filter_var($ip, FILTER_VALIDATE_IP, FILTER_FLAG_IPV6);\n    $out = $out !== false;\n    if ($exp != $out) {\n        echo \"$ip failed (expected \", $exp?\"true\":\"false\", \", got \",\n            $out?\"true\":\"false\", \")\\n\";\n    }\n}\necho \"Ok\\n\";\n?>")).toMatchSnapshot();
  });
});
