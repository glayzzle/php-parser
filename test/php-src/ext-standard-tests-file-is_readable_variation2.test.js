// eslint-disable prettier/prettier
const parser = require("../main");

describe("php-src tests", function () {
  // ext/standard/tests/file/is_readable_variation2.phpt
  it("Test is_readable() function: usage variations - file/dir with diff. perms", function () {
    expect(parser.parseCode("<?php\n/* test is_executable() with file/dir having different permissions */\nrequire __DIR__.'/file.inc';\necho \"*** Testing is_readable(): usage variations ***\\n\";\n$file_path = __DIR__;\nmkdir(\"$file_path/is_readable_variation2\");\necho \"\\n*** Testing is_readable() on directory without read permission ***\\n\";\nchmod(\"$file_path/is_readable_variation2\", 0001);\nvar_dump( is_readable(\"$file_path/is_readable_variation2\") );  // exp: bool(false)\nchmod(\"$file_path/is_readable_variation2\", 0777);  // chmod to enable deletion of directory\necho \"\\n*** Testing miscellaneous input for is_readable() function ***\\n\";\n$name_prefix = \"is_readable_variation2\";\ncreate_files(__DIR__, 1, \"numeric\", 0755, 1, \"w\", $name_prefix, 1);\ncreate_files(__DIR__, 1, \"text\", 0755, 1, \"w\", $name_prefix, 2);\ncreate_files(__DIR__, 1, \"empty\", 0755, 1, \"w\", $name_prefix, 3);\ncreate_files(__DIR__, 1, \"numeric\", 0555, 1, \"w\", $name_prefix, 4);\ncreate_files(__DIR__, 1, \"text\", 0222, 1, \"w\", $name_prefix, 5);\ncreate_files(__DIR__, 1, \"numeric\", 0711, 1, \"w\", $name_prefix, 6);\ncreate_files(__DIR__, 1, \"text\", 0411, 1, \"w\", $name_prefix, 7);\ncreate_files(__DIR__, 1, \"numeric\", 0444, 1, \"w\", $name_prefix, 8);\ncreate_files(__DIR__, 1, \"text\", 0421, 1, \"w\", $name_prefix, 9);\ncreate_files(__DIR__, 1, \"text\", 0422, 1, \"w\", $name_prefix, 10);\n$files = array (\n  \"$file_path/is_readable_variation21.tmp\",\n  \"$file_path/is_readable_variation22.tmp\",\n  \"$file_path/is_readable_variation23.tmp\",\n  \"$file_path/is_readable_variation24.tmp\",\n  \"$file_path/is_readable_variation25.tmp\",\n  \"$file_path/is_readable_variation26.tmp\",\n  \"$file_path/is_readable_variation27.tmp\",\n  \"$file_path/is_readable_variation28.tmp\",\n  \"$file_path/is_readable_variation29.tmp\",\n  \"$file_path/is_readable_variation210.tmp\"\n);\n$counter = 1;\n/* loop through to test each element in the above array\n   is a readable file */\nforeach($files as $file) {\n  echo \"-- Iteration $counter --\\n\";\n  var_dump( is_readable($file) );\n  $counter++;\n  clearstatcache();\n}\n// change all file's permissions to 777 before deleting\nchange_file_perms($file_path, 10, 0777, $name_prefix);\ndelete_files($file_path, 10, $name_prefix);\necho \"Done\\n\";\n?>")).toMatchSnapshot();
  });
});
