// eslint-disable prettier/prettier
const parser = require("../main");

describe("php-src tests", function () {
  // ext/intl/tests/dateformat_format_variant2.phpt
  it("datefmt_format_code()", function () {
    expect(parser.parseCode("<?php\n//ini_set(\"intl.error_level\", E_WARNING);\n/*\n * Test for the datefmt_format  function\n */\nfunction ut_main()\n{\n    $timezone = 'GMT-10:00';\n    $locale_arr = array (\n        'en_US'\n    );\n    $datetype_arr = array (\n                IntlDateFormatter::FULL,\n                IntlDateFormatter::LONG,\n                IntlDateFormatter::MEDIUM,\n                IntlDateFormatter::SHORT,\n                IntlDateFormatter::NONE\n        );\n        $res_str = '';\n    $time_arr = array (\n        0,\n        -1200000,\n        1200000,\n        2200000000.0,\n        -2200000000.0,\n        90099999,\n        3600,\n        -3600\n    );\n    $localtime_arr1 = array (\n        'tm_sec' => 24 ,\n        'tm_min' => 3,\n        'tm_hour' => 19,\n        'tm_mday' => 3,\n        'tm_mon' => 3,\n        'tm_year' => 105,\n    );\n    $localtime_arr2 = array (\n        'tm_sec' => 21,\n        'tm_min' => 5,\n        'tm_hour' => 7,\n        'tm_mday' => 13,\n        'tm_mon' => 4,\n        'tm_year' => 205,\n    );\n    $localtime_arr3 = array (\n            'tm_sec' => 11,\n            'tm_min' => 13,\n            'tm_hour' => 0,\n            'tm_mday' => 17,\n            'tm_mon' => 11,\n            'tm_year' => -5\n        );\n    $localtime_arr = array (\n        $localtime_arr1,\n        $localtime_arr2,\n        $localtime_arr3\n    );\n    $d1 = new DateTime(\"2010-01-01 01:02:03\", new DateTimeZone(\"UTC\"));\n    $d2 = new DateTime(\"2000-12-31 03:04:05\", new DateTimeZone(\"UTC\"));\n    $d2->setTimezone(new DateTimeZone(\"PDT\"));\n    $dates = array(\n        $d1,\n        $d2,\n        new StdClass(),\n    );\n    //Test format with input as a timestamp : integer\n    foreach( $time_arr as $timestamp_entry){\n        $res_str .= \"\\n------------\\n\";\n        $res_str .= \"\\nInput timestamp is : $timestamp_entry\";\n        $res_str .= \"\\n------------\\n\";\n        foreach( $locale_arr as $locale_entry ){\n            foreach( $datetype_arr as $datetype_entry )\n    {\n        $res_str .= \"\\nIntlDateFormatter locale= $locale_entry ,datetype = $datetype_entry ,timetype =$datetype_entry \";\n        $fmt = ut_datefmt_create( $locale_entry , $datetype_entry ,$datetype_entry, $timezone, IntlDateFormatter::GREGORIAN);\n        $formatted = ut_datefmt_format( $fmt , $timestamp_entry);\n        $res_str .= \"\\nFormatted timestamp is : $formatted\";\n    }\n    }\n    }\n    //Test format with input as a localtime :array\n    foreach( $localtime_arr as $localtime_entry){\n        $res_str .= \"\\n------------\\n\";\n        $res_str .= \"\\nInput localtime is : \";\n        foreach( $localtime_entry as $key => $value){\n                    $res_str .= \"$key : '$value' , \";\n        }\n        $res_str .= \"\\n------------\\n\";\n        foreach( $locale_arr as $locale_entry ){\n            foreach( $datetype_arr as $datetype_entry )\n    {\n        $res_str .= \"\\nIntlDateFormatter locale= $locale_entry ,datetype = $datetype_entry ,timetype =$datetype_entry \";\n        $fmt = ut_datefmt_create( $locale_entry , $datetype_entry ,$datetype_entry, $timezone, IntlDateFormatter::GREGORIAN );\n        $formatted1 = ut_datefmt_format( $fmt , $localtime_entry);\n        if( intl_get_error_code() == U_ZERO_ERROR){\n            $res_str .= \"\\nFormatted localtime_array is : $formatted1\";\n        }else{\n            $res_str .= \"\\nError while formatting as: '\".intl_get_error_message().\"'\";\n        }\n    }\n    }\n    }\n    foreach($dates as $date_entry) {\n        foreach( $locale_arr as $locale_entry ){\n            foreach( $datetype_arr as $datetype_entry ) {\n                $res_str .= \"\\n------------\";\n                $res_str .= \"\\nDate is: \".var_export($date_entry, true);\n                $res_str .= \"\\n------------\";\n                $fmt = ut_datefmt_create( $locale_entry , $datetype_entry ,$datetype_entry, $timezone, IntlDateFormatter::GREGORIAN );\n                $formatted1 = ut_datefmt_format( $fmt , $date_entry);\n                if( intl_get_error_code() == U_ZERO_ERROR){\n                    $res_str .= \"\\nFormatted DateTime is : $formatted1\";\n                }else{\n                    $res_str .= \"\\nError while formatting as: '\".intl_get_error_message().\"'\";\n                }\n            }\n        }\n    }\n    return $res_str;\n}\ninclude_once( 'ut_common.inc' );\n// Run the test\nut_run();\n?>")).toMatchSnapshot();
  });
});
