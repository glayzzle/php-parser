// eslint-disable prettier/prettier
const parser = require("../main");

describe("php-src tests", function () {
  // ext/iconv/tests/iconv_substr-charset-length-cve-2007-4783.phpt
  it("iconv_substr() charset parameter length checks (CVE-2007-4783)", function () {
    expect(parser.parseCode("<?php\n$a = str_repeat('A', 99897);\n$b = str_repeat('/', 2798349);\nvar_dump(iconv_substr($a, 0, 1, $b));\n?>")).toMatchSnapshot();
  });
});
