// eslint-disable prettier/prettier
const parser = require("../main");

describe("php-src tests", function () {
  // ext/oci8/tests/bind_misccoltypes.phpt
  it("Bind miscellaneous column types using default types", function () {
    expect(parser.parseCode("<?php\nrequire(__DIR__.'/connect.inc');\n// Initialization\n$stmtarray = array(\n    \"alter session set nls_date_format = 'DD-MON-YY'\",\n    \"drop table bind_misccoltypes_tab\",\n    \"create table bind_misccoltypes_tab (\n        id                number,\n        char_t            char(1),\n        char_t10          char(10),\n        varchar2_t10      varchar2(10),\n        number_t          number,\n        number_t92        number(9,2),\n        number_t6         number(6),\n        date_t            date,\n        timestamp_t       timestamp,\n        float_t           float,\n        binary_float_t    binary_float,\n        binary_double_t   binary_double,\n        decimal_t         decimal,\n        integer_t         integer,\n        nchar_t           nchar(10),\n        nvarchar2_t10     nvarchar2(10),\n        varchar_t10       varchar(10) )\",\n);\noci8_test_sql_execute($c, $stmtarray);\nfunction check_col($c, $colname, $id)\n{\n    $s = oci_parse($c, \"select $colname from bind_misccoltypes_tab where id = :id\");\n    oci_bind_by_name($s, \":id\", $id);\n    oci_execute($s);\n    oci_fetch_all($s, $r);\n    var_dump($r);\n}\n// Tests\necho \"\\nTEST86 insert all ORATYPE values\\n\";\n$insert_sql = \"INSERT INTO bind_misccoltypes_tab ( id, \"\n    . \"   char_t, \"\n    . \"   char_t10, \"\n    . \"   varchar2_t10, \"\n    . \"   number_t, \"\n    . \"   number_t92, \"\n    . \"   number_t6, \"\n    . \"   date_t, \"\n    . \"   timestamp_t, \"\n    . \"   float_t, \"\n    . \"   binary_float_t, \"\n    . \"   binary_double_t, \"\n    . \"   decimal_t, \"\n    . \"   integer_t, \"\n    . \"   nchar_t, \"\n    . \"   nvarchar2_t10, \"\n    . \"   varchar_t10) \"\n    . \" VALUES (:n1, \"\n    .         \" :c1, \"\n    .         \" :c2, \"\n    .         \" :c3, \"\n    .         \" :n2, \"\n    .         \" :n3, \"\n    .         \" :n4, \"\n    .         \" to_date(:d1, 'YYYY-MM-DD HH24:MI:SS'), \"\n    .         \" to_timestamp(:d1, 'YYYY-MM-DD HH24:MI:SS'), \"\n    .         \" :n5, \"\n    .         \" :n5, \"\n    .         \" :n5, \"\n    .         \" :n1, \"\n    .         \" :n1, \"\n    .         \" :c4, \"\n    .         \" :c5, \"\n    .         \" :c6) \";\n$n1 = \"86\";\n$c1 = \"C\";\n$c2 = \"char10\";\n$c3 = \"varchar210\";\n$n2 = \"-123.456\";\n$n3 = \"789.346\";\n$n4 = \"123456.023\";\n$n5 = \"12345678901234567890123456789012345678.723\";\n$d1 = \"2010-03-29 13:09:15\";\n$c4 = \"nchar10\";\n$c5 = \"nvarchar2x\";\n$c6 = \"varchar\";\n$s = oci_parse($c, $insert_sql);\noci_bind_by_name($s, \":n1\", $n1);\noci_bind_by_name($s, \":c1\", $c1);\noci_bind_by_name($s, \":c2\", $c2);\noci_bind_by_name($s, \":c3\", $c3);\noci_bind_by_name($s, \":n2\", $n2);\noci_bind_by_name($s, \":n3\", $n3);\noci_bind_by_name($s, \":n4\", $n4);\noci_bind_by_name($s, \":d1\", $d1);\noci_bind_by_name($s, \":n5\", $n5);\noci_bind_by_name($s, \":c4\", $c4);\noci_bind_by_name($s, \":c5\", $c5);\noci_bind_by_name($s, \":c6\", $c6);\noci_execute($s);\necho \"\\nTEST87 SELECT all values using DEFINEs\\n\";\n$select_sql = \"select \"\n    . \"id, \"\n    . \"char_t, \"\n    . \"char_t10, \"\n    . \"varchar2_t10, \"\n    . \"number_t, \"\n    . \"number_t92, \"\n    . \"number_t6, \"\n    . \"date_t, \"\n    . \"timestamp_t, \"\n    . \"float_t, \"\n    . \"binary_float_t, \"\n    . \"binary_double_t, \"\n    . \"decimal_t, \"\n    . \"integer_t, \"\n    . \"nchar_t, \"\n    . \"nvarchar2_t10, \"\n    . \"varchar_t10 \"\n    . \"from bind_misccoltypes_tab where id = 86\";\n$s = oci_parse($c, $select_sql);\noci_define_by_name($s, \"ID\", $ID);\noci_define_by_name($s, \"CHAR_T\", $CHAR_T);\noci_define_by_name($s, \"CHAR_T10\", $CHAR_T10);\noci_define_by_name($s, \"VARCHAR2_T10\", $VARCHAR2_T10);\noci_define_by_name($s, \"NUMBER_T\", $NUMBER_T);\noci_define_by_name($s, \"NUMBER_T92\", $NUMBER_T92);\noci_define_by_name($s, \"NUMBER_T6\", $NUMBER_T6);\noci_define_by_name($s, \"DATE_T\", $DATE_T);\noci_define_by_name($s, \"TIMESTAMP_T\", $TIMESTAMP_T);\noci_define_by_name($s, \"FLOAT_T\", $FLOAT_T);\noci_define_by_name($s, \"BINARY_FLOAT_T\", $BINARY_FLOAT_T);\noci_define_by_name($s, \"BINARY_DOUBLE_T\", $BINARY_DOUBLE_T);\noci_define_by_name($s, \"DECIMAL_T\", $DECIMAL_T);\noci_define_by_name($s, \"INTEGER_T\", $INTEGER_T);\noci_define_by_name($s, \"NCHAR_T\", $NCHAR_T);\noci_define_by_name($s, \"NVARCHAR2_T10\", $NVARCHAR2_T10);\noci_define_by_name($s, \"VARCHAR_T10\", $VARCHAR_T10);\noci_execute($s);\nwhile (oci_fetch($s)) {\n    echo \"ID is \"              . \"$ID\\n\";\n    echo \"CHAR_T is \"          . \"$CHAR_T\\n\";\n    echo \"CHAR_T10 is \"        . \"$CHAR_T10\\n\";\n    echo \"VARCHAR2_T10 is \"    . \"$VARCHAR2_T10\\n\";\n    echo \"NUMBER_T is \"        . \"$NUMBER_T\\n\";\n    echo \"NUMBER_T92 is \"      . \"$NUMBER_T92\\n\";\n    echo \"NUMBER_T6 is \"       . \"$NUMBER_T6\\n\";\n    echo \"DATE_T is \"          . \"$DATE_T\\n\";\n    echo \"TIMESTAMP_T is \"     . \"$TIMESTAMP_T\\n\";\n    echo \"FLOAT_T is \"         . \"$FLOAT_T\\n\";\n    echo \"BINARY_FLOAT_T is \"  . \"$BINARY_FLOAT_T\\n\";\n    echo \"BINARY_DOUBLE_T is \" . \"$BINARY_DOUBLE_T\\n\";\n    echo \"DECIMAL_T is \"       . \"$DECIMAL_T\\n\";\n    echo \"INTEGER_T is \"       . \"$INTEGER_T\\n\";\n    echo \"NCHAR_T is \"         . \"$NCHAR_T\\n\";\n    echo \"NVARCHAR2_T10 is \"   . \"$NVARCHAR2_T10\\n\";\n    echo \"VARCHAR_T10 is \"     . \"$VARCHAR_T10\\n\";\n}\necho \"\\nTEST52 insert numbers\\n\";\n$s = oci_parse($c, \"INSERT INTO bind_misccoltypes_tab (id, number_t92) VALUES (52, :n1)\");\n$n1 = 3;\noci_bind_by_name($s, \":n1\", $n1);\noci_execute($s);\ncheck_col($c, 'number_t92', 52);\necho \"\\nTEST53 insert numbers \\n\";\n$s = oci_parse($c, \"INSERT INTO bind_misccoltypes_tab (id, number_t92) VALUES (53, :n1)\");\n$n1 = 8.67;\noci_bind_by_name($s, \":n1\", $n1);\noci_execute($s);\ncheck_col($c, 'number_t92', 53);\necho \"\\nTEST54 insert numbers \\n\";\n$s = oci_parse($c, \"INSERT INTO bind_misccoltypes_tab (id, number_t) VALUES (54, :n1)\");\n$n1 = 4.67;\noci_bind_by_name($s, \":n1\", $n1);\noci_execute($s);\ncheck_col($c, 'number_t', 54);\necho \"\\nTEST55 insert numbers \\n\";\n$s = oci_parse($c, \"INSERT INTO bind_misccoltypes_tab (id, number_t) VALUES (55, :n1)\");\n$n1 = \"7.67\";\noci_bind_by_name($s, \":n1\", $n1);\noci_execute($s);\ncheck_col($c, 'number_t', 55);\necho \"\\nTEST56 insert numbers \\n\";\n$n1 = -5.67;\n$s = oci_parse($c, \"INSERT INTO bind_misccoltypes_tab (id, number_t) VALUES (56, :n1)\");\noci_bind_by_name($s, \":n1\", $n1);\noci_execute($s);\ncheck_col($c, 'number_t', 56);\necho \"\\nTEST58 insert a VARCHAR2\\n\";\n$s = oci_parse($c, \"INSERT INTO bind_misccoltypes_tab (id, varchar2_t10) VALUES (58, :c2)\");\n$c2 = \"Hood\";\noci_bind_by_name($s, \":c2\", $c2);\noci_execute($s);\ncheck_col($c, 'varchar2_t10', 58);\necho \"\\nTEST59 insert a VARCHAR2\\n\";\n$s = oci_parse($c, \"INSERT INTO bind_misccoltypes_tab (id, char_t10) VALUES (59, :c2)\");\n$c2 = \"Hood\";\noci_bind_by_name($s, \":c2\", $c2);\noci_execute($s);\ncheck_col($c, 'char_t10', 59);\necho \"\\nTEST60 insert a date\\n\";\n$s = oci_parse($c, \"INSERT INTO bind_misccoltypes_tab (id, date_t) VALUES (60, to_date(:c2, 'YYYY-MM-DD'))\");\n$c2 = '2010-04-09';\noci_bind_by_name($s, \":c2\", $c2);\noci_execute($s);\ncheck_col($c, 'date_t', 60);\n// Clean up\n$stmtarray = array(\n    \"drop table bind_misccoltypes_tab\"\n);\noci8_test_sql_execute($c, $stmtarray);\noci_close($c);\n?>")).toMatchSnapshot();
  });
});
