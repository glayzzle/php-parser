// eslint-disable prettier/prettier
const parser = require("../main");

describe("php-src tests", function () {
  // ext/hash/tests/hash_hmac_file_basic.phpt
  it("Hash: hash_hmac_file() function : basic functionality", function () {
    expect(parser.parseCode("<?php\necho \"*** Testing hash_hmac_file() : basic functionality ***\\n\";\n$file = __DIR__ . \"hash_hmac_file.txt\";\n/* Creating a temporary file file */\nif (($fp = fopen( $file, \"w+\")) == FALSE) {\n    echo \"Cannot create file ($file)\";\n    exit;\n}\n/* Writing into file */\n$content = \"This is a sample string used to test the hash_hmac_file function with various hashing algorithms\";\nif (is_writable($file)) {\n  if (fwrite($fp, $content) === FALSE) {\n    echo \"Cannot write to file ($file)\";\n    exit;\n  }\n}\n// close the files\nfclose($fp);\n$key = 'secret';\necho \"gost: \" . hash_hmac_file('gost', $file, $key) . \"\\n\";\necho \"haval128,3: \" . hash_hmac_file('haval128,3', $file, $key) . \"\\n\";\necho \"md2: \" . hash_hmac_file('md2', $file, $key) . \"\\n\";\necho \"md4: \" . hash_hmac_file('md4', $file, $key) . \"\\n\";\necho \"md5: \" . hash_hmac_file('md5', $file, $key) . \"\\n\";\necho \"ripemd128: \" . hash_hmac_file('ripemd128', $file, $key) . \"\\n\";\necho \"ripemd160: \" . hash_hmac_file('ripemd160', $file, $key) . \"\\n\";\necho \"ripemd256: \" . hash_hmac_file('ripemd256', $file, $key) . \"\\n\";\necho \"ripemd320: \" . hash_hmac_file('ripemd320', $file, $key) . \"\\n\";\necho \"sha1: \" . hash_hmac_file('sha1', $file, $key) . \"\\n\";\necho \"sha256: \" . hash_hmac_file('sha256', $file, $key) . \"\\n\";\necho \"sha384: \" . hash_hmac_file('sha384', $file, $key) . \"\\n\";\necho \"sha512: \" . hash_hmac_file('sha512', $file, $key) . \"\\n\";\necho \"snefru: \" . hash_hmac_file('snefru', $file, $key) . \"\\n\";\necho \"tiger192,3: \" . hash_hmac_file('tiger192,3', $file, $key) . \"\\n\";\necho \"whirlpool: \" . hash_hmac_file('whirlpool', $file, $key) . \"\\n\";\necho \"md5(raw): \" . bin2hex(hash_hmac_file('md5', $file, $key, TRUE)). \"\\n\";\necho \"sha256(raw): \" . bin2hex(hash_hmac_file('sha256', $file, $key, TRUE)). \"\\n\";\nunlink($file);\n?>")).toMatchSnapshot();
  });
});
