// eslint-disable prettier/prettier
const parser = require("../main");

describe("php-src tests", function () {
  // ext/iconv/tests/iconv-charset-length-cve-2007-4840.phpt
  it("iconv() charset parameter length checks (CVE-2007-4840)", function () {
    expect(parser.parseCode("<?php\n$a = str_repeat(\"/\", 9000000);\nvar_dump(iconv($a, \"b\", \"test\"));\nvar_dump(iconv(\"x\", $a, \"test\"));\n?>")).toMatchSnapshot();
  });
});
