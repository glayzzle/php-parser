// eslint-disable prettier/prettier
const parser = require("../main");

describe("php-src tests", function () {
  // ext/standard/tests/file/is_executable_variation2.phpt
  it("Test is_executable() function: usage variations - file/dir with diff. perms", function () {
    expect(parser.parseCode("<?php\n/* test is_executable() with file/dir having different permissions */\nrequire __DIR__.'/file.inc';\necho \"*** Testing is_executable(): usage variations ***\\n\";\n$file_path = __DIR__;\nmkdir(\"$file_path/is_executable_variation2\");\necho \"\\n*** Testing is_executable() on directory without execute permission ***\\n\";\nchmod(\"$file_path/is_executable_variation2\", 0444);\nvar_dump( is_executable(\"$file_path/is_executable_variation2\") );  // exp: bool(false)\nchmod(\"$file_path/is_executable_variation2\", 0777);  // chmod to enable deletion of directory\necho \"\\n*** Testing miscellaneous input for is_executable() function ***\\n\";\n$name_prefix = \"is_executable_variation2\";\ncreate_files(__DIR__, 1, \"numeric\", 0755, 1, \"w\", $name_prefix, 1);\ncreate_files(__DIR__, 1, \"text\", 0755, 1, \"w\", $name_prefix, 2);\ncreate_files(__DIR__, 1, \"empty\", 0755, 1, \"w\", $name_prefix, 3);\ncreate_files(__DIR__, 1, \"numeric\", 0755, 1, \"w\", $name_prefix, 4);\ncreate_files(__DIR__, 1, \"text\", 0222, 1, \"w\", $name_prefix, 5);\ncreate_files(__DIR__, 1, \"numeric\", 0711, 1, \"w\", $name_prefix, 6);\ncreate_files(__DIR__, 1, \"text\", 0714, 1, \"w\", $name_prefix, 7);\ncreate_files(__DIR__, 1, \"numeric\", 0744, 1, \"w\", $name_prefix, 8);\ncreate_files(__DIR__, 1, \"text\", 0421, 1, \"w\", $name_prefix, 9);\ncreate_files(__DIR__, 1, \"text\", 0712, 1, \"w\", $name_prefix, 10);\n$files = array (\n  \"$file_path/is_executable_variation21.tmp\",\n  \"$file_path/is_executable_variation22.tmp\",\n  \"$file_path/is_executable_variation23.tmp\",\n  \"$file_path/is_executable_variation24.tmp\",\n  \"$file_path/is_executable_variation25.tmp\",\n  \"$file_path/is_executable_variation26.tmp\",\n  \"$file_path/is_executable_variation27.tmp\",\n  \"$file_path/is_executable_variation28.tmp\",\n  \"$file_path/is_executable_variation29.tmp\",\n  \"$file_path/is_executable_variation210.tmp\",\n);\n$counter = 1;\n/* loop through to test each element in the above array\n   is an executable file */\nforeach($files as $file) {\n  echo \"-- Iteration $counter --\\n\";\n  var_dump( is_executable($file) );\n  $counter++;\n  clearstatcache();\n}\n// change all file's permissions to 777 before deleting\nchange_file_perms($file_path, 10, 0777, $name_prefix);\ndelete_files($file_path, 10, $name_prefix);\necho \"Done\\n\";\n?>")).toMatchSnapshot();
  });
});
