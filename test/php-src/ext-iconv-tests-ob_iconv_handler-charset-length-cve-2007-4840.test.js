// eslint-disable prettier/prettier
const parser = require("../main");

describe("php-src tests", function () {
  // ext/iconv/tests/ob_iconv_handler-charset-length-cve-2007-4840.phpt
  it("ob_iconv_handler() charset parameter length checks (CVE-2007-4840)", function () {
    expect(parser.parseCode("<?php\nini_set(\"iconv.output_encoding\", str_repeat(\"a\", 9000000));\nob_start(\"ob_iconv_handler\");\nprint \"done\";\n?>")).toMatchSnapshot();
  });
});
