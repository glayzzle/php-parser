// eslint-disable prettier/prettier
const parser = require("../main");

describe("php-src tests", function () {
  // ext/fileinfo/tests/cve-2014-1943-mb.phpt
  it("Bug #66731: file: infinite recursion", function () {
    expect(parser.parseCode("<?php\n$fd = __DIR__.'/cve-2014-1943私はガラスを食べられます.data';\n$fm = __DIR__.'/cve-2014-1943私はガラスを食べられます.magic';\n$a = \"\\105\\122\\000\\000\\000\\000\\000\";\n$b = str_repeat(\"\\001\", 250000);\n$m =  \"0           byte        x\\n\".\n      \">(1.b)      indirect    x\\n\";\nfile_put_contents($fd, $a);\n$fi = finfo_open(FILEINFO_NONE);\nvar_dump(finfo_file($fi, $fd));\nfinfo_close($fi);\nfile_put_contents($fd, $b);\nfile_put_contents($fm, $m);\n$fi = finfo_open(FILEINFO_NONE, $fm);\nvar_dump(finfo_file($fi, $fd));\nfinfo_close($fi);\n?>\nDone")).toMatchSnapshot();
  });
});
