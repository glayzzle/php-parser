// eslint-disable prettier/prettier
const parser = require("../main");

describe("php-src tests", function () {
  // ext/oci8/tests/coll_019.phpt
  it("Test collection Oracle error handling collections and numbers (2)", function () {
    expect(parser.parseCode("<?php\nerror_reporting(E_ALL ^ E_DEPRECATED);\nrequire __DIR__.\"/connect.inc\";\n$ora_sql = \"DROP TYPE \".$type_name;\n$statement = oci_parse($c,$ora_sql);\n@oci_execute($statement);\necho \"Test 0\\n\";\n$ora_sql = \"CREATE TYPE \".$type_name.\" AS TABLE OF BLOB\";\n$statement = oci_parse($c,$ora_sql);\noci_execute($statement);\n$coll1 = oci_new_collection($c, $type_name);\nvar_dump($coll1->append('a long string'));              // invalid type for append\nvar_dump($coll1->assignElem(1, 'a long string')); \t// invalid type for assignelem()\nvar_dump($coll1->getElem(0));\nrequire __DIR__.\"/drop_type.inc\";\necho \"Test 1\\n\";\n$ora_sql = \"CREATE TYPE \".$type_name.\" AS TABLE OF NUMBER\";\n$statement = oci_parse($c,$ora_sql);\noci_execute($statement);\n$coll1 = oci_new_collection($c, $type_name);\nvar_dump($coll1->assignElem(1, null));\t\t\t// invalid location for null\nvar_dump($coll1->getElem(0));\necho \"Test 2\\n\";\nvar_dump($coll1->assignElem(1, 1234));  \t\t// invalid location for number\nvar_dump($coll1->getElem(0));\nrequire __DIR__.\"/drop_type.inc\";\necho \"Test 3\\n\";\n$ora_sql = \"CREATE TYPE \".$type_name.\" AS TABLE OF VARCHAR2(1)\";\n$statement = oci_parse($c,$ora_sql);\noci_execute($statement);\n$coll1 = oci_new_collection($c, $type_name);\nvar_dump($coll1->assignElem(1, 'abc')); \t\t// invalid location for string\nvar_dump($coll1->getElem(0));\nrequire __DIR__.\"/drop_type.inc\";\necho \"Test 4\\n\";\n$ora_sql = \"CREATE TYPE \".$type_name.\" AS TABLE OF DATE\";\n$statement = oci_parse($c,$ora_sql);\noci_execute($statement);\n$coll1 = oci_new_collection($c, $type_name);\nvar_dump($coll1->append(1));                   \t\t// invalid date format\nvar_dump($coll1->assignElem(1, '01-JAN-06'));  \t\t// invalid location for date\nvar_dump($coll1->getElem(0));\nrequire __DIR__.\"/drop_type.inc\";\necho \"Done\\n\";\n?>")).toMatchSnapshot();
  });
});
