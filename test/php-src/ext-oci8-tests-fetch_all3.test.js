// eslint-disable prettier/prettier
const parser = require("../main");

describe("php-src tests", function () {
  // ext/oci8/tests/fetch_all3.phpt
  it("oci_fetch_all() - all combinations of flags", function () {
    expect(parser.parseCode("<?php\nrequire(__DIR__.\"/connect.inc\");\n// Initialize\n$stmtarray = array(\n    \"drop table fetch_all3_tab\",\n    \"create table fetch_all3_tab (id number, value number)\",\n);\noci8_test_sql_execute($c, $stmtarray);\n$insert_sql = \"insert into fetch_all3_tab (id, value) values (:idbv,:vbv)\";\n$s = oci_parse($c, $insert_sql);\noci_bind_by_name($s, \":idbv\", $idbv, -1, SQLT_INT);\noci_bind_by_name($s, \":vbv\", $vbv, -1, SQLT_INT);\nfor ($i = 1; $i <= 4; $i++) {\n    $idbv = $i;\n    $vbv = -$i;\n    oci_execute($s, OCI_DEFAULT);\n}\noci_commit($c);\n// Run Test\n$select_sql = \"select id, value from fetch_all3_tab order by id\";\n$s = oci_parse($c, $select_sql);\necho \"None\\n\";\noci_execute($s);\nvar_dump(oci_fetch_all($s, $all, 0, -1));\nvar_dump($all);\necho \"OCI_ASSOC\\n\";\noci_execute($s);\nvar_dump(oci_fetch_all($s, $all, 0, -1, OCI_ASSOC));\nvar_dump($all);\necho \"OCI_FETCHSTATEMENT_BY_COLUMN\\n\";\noci_execute($s);\nvar_dump(oci_fetch_all($s, $all, 0, -1, OCI_FETCHSTATEMENT_BY_COLUMN));\nvar_dump($all);\necho \"OCI_FETCHSTATEMENT_BY_COLUMN|OCI_ASSOC\\n\";\noci_execute($s);\nvar_dump(oci_fetch_all($s, $all, 0, -1, OCI_FETCHSTATEMENT_BY_COLUMN|OCI_ASSOC));\nvar_dump($all);\necho \"OCI_FETCHSTATEMENT_BY_COLUMN|OCI_NUM\\n\";\noci_execute($s);\nvar_dump(oci_fetch_all($s, $all, 0, -1, OCI_FETCHSTATEMENT_BY_COLUMN|OCI_NUM));\nvar_dump($all);\necho \"OCI_FETCHSTATEMENT_BY_COLUMN|OCI_NUM|OCI_ASSOC\\n\";\noci_execute($s);\nvar_dump(oci_fetch_all($s, $all, 0, -1, OCI_FETCHSTATEMENT_BY_COLUMN|OCI_NUM|OCI_ASSOC));\nvar_dump($all);\necho \"OCI_FETCHSTATEMENT_BY_ROW\\n\";\noci_execute($s);\nvar_dump(oci_fetch_all($s, $all, 0, -1, OCI_FETCHSTATEMENT_BY_ROW));\nvar_dump($all);\necho \"OCI_FETCHSTATEMENT_BY_ROW|OCI_ASSOC\\n\";\noci_execute($s);\nvar_dump(oci_fetch_all($s, $all, 0, -1, OCI_FETCHSTATEMENT_BY_ROW|OCI_ASSOC));\nvar_dump($all);\necho \"OCI_FETCHSTATEMENT_BY_ROW|OCI_FETCHSTATEMENT_BY_COLUMN\\n\";\noci_execute($s);\nvar_dump(oci_fetch_all($s, $all, 0, -1, OCI_FETCHSTATEMENT_BY_ROW|OCI_FETCHSTATEMENT_BY_COLUMN));\nvar_dump($all);\necho \"OCI_FETCHSTATEMENT_BY_ROW|OCI_FETCHSTATEMENT_BY_COLUMN|OCI_ASSOC\\n\";\noci_execute($s);\nvar_dump(oci_fetch_all($s, $all, 0, -1, OCI_FETCHSTATEMENT_BY_ROW|OCI_FETCHSTATEMENT_BY_COLUMN|OCI_ASSOC));\nvar_dump($all);\necho \"OCI_FETCHSTATEMENT_BY_ROW|OCI_FETCHSTATEMENT_BY_COLUMN|OCI_NUM\\n\";\noci_execute($s);\nvar_dump(oci_fetch_all($s, $all, 0, -1, OCI_FETCHSTATEMENT_BY_ROW|OCI_FETCHSTATEMENT_BY_COLUMN|OCI_NUM));\nvar_dump($all);\necho \"OCI_FETCHSTATEMENT_BY_ROW|OCI_FETCHSTATEMENT_BY_COLUMN|OCI_NUM|OCI_ASSOC\\n\";\noci_execute($s);\nvar_dump(oci_fetch_all($s, $all, 0, -1, OCI_FETCHSTATEMENT_BY_ROW|OCI_FETCHSTATEMENT_BY_COLUMN|OCI_NUM|OCI_ASSOC));\nvar_dump($all);\necho \"OCI_FETCHSTATEMENT_BY_ROW|OCI_NUM\\n\";\noci_execute($s);\nvar_dump(oci_fetch_all($s, $all, 0, -1, OCI_FETCHSTATEMENT_BY_ROW|OCI_NUM));\nvar_dump($all);\necho \"OCI_FETCHSTATEMENT_BY_ROW|OCI_NUM|OCI_ASSOC\\n\";\noci_execute($s);\nvar_dump(oci_fetch_all($s, $all, 0, -1, OCI_FETCHSTATEMENT_BY_ROW|OCI_NUM|OCI_ASSOC));\nvar_dump($all);\necho \"OCI_NUM\\n\";\noci_execute($s);\nvar_dump(oci_fetch_all($s, $all, 0, -1, OCI_NUM));\nvar_dump($all);\necho \"OCI_NUM|OCI_ASSOC\\n\";\noci_execute($s);\nvar_dump(oci_fetch_all($s, $all, 0, -1, OCI_NUM|OCI_ASSOC));\nvar_dump($all);\n// Cleanup\n$stmtarray = array(\n    \"drop table fetch_all3_tab\"\n);\noci8_test_sql_execute($c, $stmtarray);\necho \"Done\\n\";\n?>")).toMatchSnapshot();
  });
});
