// eslint-disable prettier/prettier
const parser = require("../main");

describe("php-src tests", function () {
  // ext/gd/tests/lines.phpt
  it("imageline no AA", function () {
    expect(parser.parseCode("<?php\n$im = imagecreatetruecolor(6,6);\nimagefill($im, 0,0, 0xffffff);\n// Horizontal line\nimageline($im, 0,5, 5,5, 0x00ff00);\n$p1 = imagecolorat($im, 0,5)==0x00ff00;\n$p2 = imagecolorat($im, 5,5)==0x00ff00;\n$p3 = true;\nfor ($x=1; $x<5; $x++) {\n    $p3 = $p3 && (imagecolorat($im, $x,5)==0x00ff00);\n}\nif ($p1 && $p2 && $p3) {\n    echo \"Horizontal: ok\\n\";\n}\n$im = imagecreatetruecolor(6,6);\nimagefill($im, 0,0, 0xffffff);\nimageline($im, 0,0, 0,5, 0x00ff00);\n$p1 = imagecolorat($im, 0,0)==0x00ff00;\n$p2 = imagecolorat($im, 0,5)==0x00ff00;\n$p3 = true;\nfor ($y=1; $y<5; $y++) {\n    $p3 = $p3 && (imagecolorat($im, 0,$y)==0x00ff00);\n}\nif ($p1 && $p2 && $p3) {\n    echo \"Vertical: ok\\n\";\n}\n$im = imagecreatetruecolor(6,6);\nimagefill($im, 0,0, 0xffffff);\nimageline($im, 0,0, 5,5, 0x00ff00);\n// Diagonal\n$p1 = imagecolorat($im, 0,0)==0x00ff00;\n$p2 = imagecolorat($im, 5,5)==0x00ff00;\n$x=1;\n$p3 = true;\nfor ($y=1; $y<5; $y++) {\n    $p3 = $p3 && (imagecolorat($im, $x,$y)==0x00ff00);\n    $x++;\n}\nif ($p1 && $p2 && $p3) {\n    echo \"Diagonal: ok\\n\";\n}\n// Outside\n$im = imagecreatetruecolor(6,6);\nimagefill($im, 0,0, 0xffffff);\nimageline($im, 12, 12, 23,23, 0x00ff00);\n$p3 = true;\nfor ($x=0; $x<6; $x++) {\n    for ($y=0; $y<6; $y++) {\n        $p3 = $p3 && (imagecolorat($im, $x,$y)!=0x00ff00);\n    }\n}\nif ($p3) {\n    echo \"Outside 1: ok\\n\";\n}\n$im = imagecreatetruecolor(6,6);\nimagefill($im, 0,0, 0xffffff);\nimageline($im, -12, -12, -23,-23, 0x00ff00);\n$p3 = true;\nfor ($x=0; $x<6; $x++) {\n    for ($y=0; $y<6; $y++) {\n        $p3 = $p3 && (imagecolorat($im, $x,$y)!=0x00ff00);\n    }\n}\nif ($p3) {\n    echo \"Outside 2: ok\\n\";\n}\n$im = imagecreatetruecolor(6,6);\nimagefill($im, 0,0, 0xffffff);\nimageline($im, -1, -1, 4,4, 0x00ff00);\n$p3 = true;\nfor ($x=0; $x<5; $x++) {\n    for ($y=0; $y<5; $y++) {\n        $p3 = $p3 && (imagecolorat($im, $x,$y)==0x00ff00);\n    }\n}\nif ($p3) {\n    echo \"Outside 2: ok\\n\";\n}\n?>")).toMatchSnapshot();
  });
});
